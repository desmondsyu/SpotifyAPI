<!--/*****************************************************************************
ITC5202 â€“ Project 2
I declare that this assignment is my own work in accordance with Humber Academic Policy.
No part of this assignment has been copied manually or electronically from any other source
(including web sites) or distributed to other students.
Group member Name: 
Student IDs:
Date:
****************************************************************************-->
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Explore Genres</title>
    <link rel="icon" href="Image/webpage_icon.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="Style/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>

        const clientId = `0478ce6c643f44508e01522adc3e32c6`;
        const clientSecret = `832578ce742b455a875ee2e405d6a6c1`;
        let accessToken = null;

        const getToken = async () => {
            const result = await fetch("https://accounts.spotify.com/api/token", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded",
                    Authorization: "Basic " + btoa(`${clientId}:${clientSecret}`),
                },
                body: "grant_type=client_credentials",
            });
            const data = await result.json();
            accessToken = data.access_token;

            // call api of genre and get return data
            fetch("https://api.spotify.com/v1/browse/categories?limit=50", {
                headers: {
                    Authorization: "Bearer " + accessToken,
                },
            })
                .then(response => response.json())
                .then(data => {
                    // show genres in console
                    console.log("API Response:", data);

                    // add json item into list of page
                    const genreList = document.getElementById('genre-list');
                    data.categories.items.forEach(genre => {
                        const capitalizedGenre = genre.charAt(0).toUpperCase() + genre.slice(1);
                        const listItem = document.createElement('p');
                        listItem.textContent = capitalizedGenre;
                        listItem.style.backgroundColor = getRandomDarkColor();
                        genreList.appendChild(listItem);
                    });
                })
                .catch(error => {
                    console.error("Error fetching API:", error);
                });
        };

        getToken();

        // generate random dark backgroud colors
        function getRandomDarkColor() {
            var letters = '0123456789ABCDEF';
            var color = '#';
            for (var i = 0; i < 3; i++) {
                var value = Math.floor(Math.random() * 192);
                color += (value < 16 ? '0' : '') + value.toString(16);
            }
            return color;
        }
    </script>

</head>

<body>
    <header>
        <!-- Search bar section -->
        <section id="search-bar">
            <input type="text" id="search-input" placeholder="What do you want to play?">
            <div>
                <button id="search-button">Search</button>
                <button id="reset-button">Reset</button>
            </div>
        </section>
        <script>
            // Filter genres based on search input
            document.getElementById('search-button').addEventListener('click', () => {
                const searchInput = document.getElementById('search-input').value.toLowerCase();
                const genreItems = document.querySelectorAll('#genre-list p');
                genreItems.forEach(item => {
                    const genre = item.textContent.toLowerCase();
                    if (genre.includes(searchInput)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });

            // Reset genre list to show all genres
            document.getElementById('reset-button').addEventListener('click', () => {
                const genreItems = document.querySelectorAll('#genre-list p');
                genreItems.forEach(item => {
                    item.style.display = 'flex';
                });
                const searchInput = document.getElementById('search-input');
                searchInput.value = '';
            });
        </script>

        <!-- logo section -->
        <section id="logo">
            <img src="Image/Spotify_Logo_RGB_Green.png" alt="spotifylogo" width="500" height="600">
        </section>
    </header>

    <main>
        <!-- Genre list section -->
        <section id="list">
            <div id="genre-list">
            </div>
        </section>
    </main>

    <footer>
        <section id="copyright">
            <p>&copy; Group 6 Giovanny and Desmond</p>
        </section>
    </footer>
</body>

</html>